<!-- Encabezado y botón -->
<div class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center mb-4">
  <h3 class="mb-2 mb-md-0">Lista de Productos</h3>
  <button class="btn btn-primary" (click)="addProduct()">Agregar producto</button>
</div>

<!-- Tabla de productos o mensaje si no hay productos -->
<div *ngIf="paginatedProducts.length > 0; else noProducts">
  <div class="table-responsive">
    <table class="table table-striped table-hover text-center align-middle">
      <thead class="table-dark">
        <tr>
          <th>#</th>
          <th>Nombre</th>
          <th>Precio</th>
          <th>Stock</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let product of paginatedProducts">
          <th scope="row">{{ product.id }}</th>
          <td>{{ product.name }}</td>
          <td>{{ product.price | currency:'CLP':'symbol':'1.0-0' }}</td>
          <td>{{ product.stock }}</td>
          <td>
            <button class="btn btn-danger btn-sm" (click)="deleteProduct(product.id)">Eliminar</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Paginación y selector -->
  <div class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center mt-3 gap-2">
    <ngb-pagination
      [collectionSize]="collectionSize"
      [(page)]="page"
      [pageSize]="pageSize"
      (pageChange)="onPageChange($event)"
      [maxSize]="maxSize"
      [ellipses]="true"
      [boundaryLinks]="true">
    </ngb-pagination>

    <div class="d-flex align-items-center gap-2">
      <label class="mb-0">Items por página:</label>
      <select class="form-select w-auto" [(ngModel)]="pageSize" (ngModelChange)="onPageSizeChange($event)">
        <option [ngValue]="2">2</option>
        <option [ngValue]="4">4</option>
        <option [ngValue]="6">6</option>
      </select>
    </div>
  </div>
</div>

<!-- Template alternativo si no hay productos -->
<ng-template #noProducts>
  <div class="text-center p-5">
    <h5>No hay productos disponibles.</h5>
    <p class="mt-3">Para generar y levantar la base de datos, sigue estos pasos:</p>

    <div class="mt-2">
      <p class="mb-1"><strong>1. Generar la base de datos:</strong></p>
      <code class="p-2 bg-light border rounded d-block mb-2">
        node generar-db.js
      </code>

      <p class="mb-1"><strong>2. Iniciar la base de datos:</strong></p>
      <code class="p-2 bg-light border rounded d-block mb-2">
        json-server --watch db.json --port 3000
      </code>
    </div>

    <p class="mt-3 text-warning"><strong>⚠️ Después de ejecutar los comandos, actualiza la página para ver los productos.</strong></p>
  </div>
</ng-template>